var that=this;function __skpm_run(e,t){that.context=t;var n=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/DataProvider.js")}({"./node_modules/@skpm/fs/index.js":
/*!****************************************!*\
  !*** ./node_modules/@skpm/fs/index.js ***!
  \****************************************/
/*! no static exports found */function(e,t,n){var r=n(/*! buffer */"buffer").Buffer,i={"-2":"no such file or directory","-13":"permission denied","-21":"illegal operation on a directory"};function o(e){var t=new Error(e.code+": "+i[e.errno]+", "+e.syscall+(e.path?" '"+e.path+"'":""));return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}function a(e,t){return e&&e.encoding?String(e.encoding):e?String(e):t}e.exports.constants={F_OK:0,R_OK:4,W_OK:2,X_OK:1},e.exports.accessSync=function(t,n){n|=0;var r=NSFileManager.defaultManager();switch(n){case 0:canAccess=e.exports.existsSync(t);break;case 1:canAccess=Boolean(Number(r.isExecutableFileAtPath(t)));break;case 2:canAccess=Boolean(Number(r.isWritableFileAtPath(t)));break;case 3:canAccess=Boolean(Number(r.isExecutableFileAtPath(t)))&&Boolean(Number(r.isWritableFileAtPath(t)));break;case 4:canAccess=Boolean(Number(r.isReadableFileAtPath(t)));break;case 5:canAccess=Boolean(Number(r.isReadableFileAtPath(t)))&&Boolean(Number(r.isExecutableFileAtPath(t)));break;case 6:canAccess=Boolean(Number(r.isReadableFileAtPath(t)))&&Boolean(Number(r.isWritableFileAtPath(t)));break;case 7:canAccess=Boolean(Number(r.isReadableFileAtPath(t)))&&Boolean(Number(r.isWritableFileAtPath(t)))&&Boolean(Number(r.isExecutableFileAtPath(t)))}if(!canAccess)throw new Error("Can't access "+String(t))},e.exports.appendFileSync=function(t,n,i){if(!e.exports.existsSync(t))return e.exports.writeFileSync(t,n,i);var o=NSFileHandle.fileHandleForWritingAtPath(t);o.seekToEndOfFile();var c=a(i,"utf8"),s=r.from(n,"NSData"===c||"buffer"===c?void 0:c).toNSData();o.writeData(s)},e.exports.chmodSync=function(e,t){var n=MOPointer.alloc().init();if(NSFileManager.defaultManager().setAttributes_ofItemAtPath_error({NSFilePosixPermissions:t},e,n),null!==n.value())throw new Error(n.value())},e.exports.copyFileSync=function(e,t,n){var r=MOPointer.alloc().init();if(NSFileManager.defaultManager().copyItemAtPath_toPath_error(e,t,r),null!==r.value())throw new Error(r.value())},e.exports.existsSync=function(e){var t=NSFileManager.defaultManager();return Boolean(Number(t.fileExistsAtPath(e)))},e.exports.linkSync=function(e,t){var n=MOPointer.alloc().init();if(NSFileManager.defaultManager().linkItemAtPath_toPath_error(e,t,n),null!==n.value())throw new Error(n.value())},e.exports.mkdirSync=function(e,t){t=t||511;var n=MOPointer.alloc().init();if(NSFileManager.defaultManager().createDirectoryAtPath_withIntermediateDirectories_attributes_error(e,!1,{NSFilePosixPermissions:t},n),null!==n.value())throw new Error(n.value())},e.exports.mkdtempSync=function(t){var n=t+function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<6;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}();return e.exports.mkdirSync(n),n},e.exports.readdirSync=function(e){for(var t=NSFileManager.defaultManager().subpathsAtPath(e),n=[],r=0;r<t.length;r++)n.push(String(t[r]));return n},e.exports.readFileSync=function(e,t){var n=a(t,"buffer"),i=NSFileManager.defaultManager(),c=i.contentsAtPath(e);if(!c){if(!i.fileExistsAtPath(e))throw o({errno:-2,code:"ENOENT",syscall:"open",path:e});if(!i.isReadableFileAtPath(e))throw o({errno:-13,code:"EACCES",syscall:"open",path:e});if(i.fileExistsAtPath_isDirectory(e,!0))throw o({errno:-21,code:"EISDIR",syscall:"read"});throw new Error("Unknown error while reading file "+e)}var s=r.from(c);return"buffer"===n?s:"NSData"===n?s.toNSData():s.toString(n)},e.exports.readlinkSync=function(e){var t=MOPointer.alloc().init(),n=NSFileManager.defaultManager().destinationOfSymbolicLinkAtPath_error(e,t);if(null!==t.value())throw new Error(t.value());return String(n)},e.exports.realpathSync=function(e){return String(NSString.stringByResolvingSymlinksInPath(e))},e.exports.renameSync=function(e,t){var n=MOPointer.alloc().init(),r=NSFileManager.defaultManager();r.moveItemAtPath_toPath_error(e,t,n);var i=n.value();if(null!==i){if("NSCocoaErrorDomain"!==String(i.domain())||516!==Number(i.code()))throw new Error(i);var o=MOPointer.alloc().init();if(r.replaceItemAtURL_withItemAtURL_backupItemName_options_resultingItemURL_error(NSURL.fileURLWithPath(t),NSURL.fileURLWithPath(e),null,NSFileManagerItemReplacementUsingNewMetadataOnly,null,o),null!==o.value())throw new Error(o.value())}},e.exports.rmdirSync=function(e){var t=MOPointer.alloc().init();if(NSFileManager.defaultManager().removeItemAtPath_error(e,t),null!==t.value())throw new Error(t.value())},e.exports.lstatSync=function(e){var t=MOPointer.alloc().init(),n=NSFileManager.defaultManager().attributesOfItemAtPath_error(e,t);if(null!==t.value())throw new Error(t.value());return function(e){return{dev:String(e.NSFileDeviceIdentifier),mode:e.NSFileType|e.NSFilePosixPermissions,nlink:Number(e.NSFileReferenceCount),uid:String(e.NSFileOwnerAccountID),gid:String(e.NSFileGroupOwnerAccountID),size:Number(e.NSFileSize),atimeMs:1e3*Number(e.NSFileModificationDate.timeIntervalSince1970()),mtimeMs:1e3*Number(e.NSFileModificationDate.timeIntervalSince1970()),ctimeMs:1e3*Number(e.NSFileModificationDate.timeIntervalSince1970()),birthtimeMs:1e3*Number(e.NSFileCreationDate.timeIntervalSince1970()),atime:new Date(1e3*Number(e.NSFileModificationDate.timeIntervalSince1970())+.5),mtime:new Date(1e3*Number(e.NSFileModificationDate.timeIntervalSince1970())+.5),ctime:new Date(1e3*Number(e.NSFileModificationDate.timeIntervalSince1970())+.5),birthtime:new Date(1e3*Number(e.NSFileCreationDate.timeIntervalSince1970())+.5),isBlockDevice:function(){return e.NSFileType===NSFileTypeBlockSpecial},isCharacterDevice:function(){return e.NSFileType===NSFileTypeCharacterSpecial},isDirectory:function(){return e.NSFileType===NSFileTypeDirectory},isFIFO:function(){return!1},isFile:function(){return e.NSFileType===NSFileTypeRegular},isSocket:function(){return e.NSFileType===NSFileTypeSocket},isSymbolicLink:function(){return e.NSFileType===NSFileTypeSymbolicLink}}}(n)},e.exports.statSync=function(t){return e.exports.lstatSync(e.exports.realpathSync(t))},e.exports.symlinkSync=function(e,t){var n=MOPointer.alloc().init();NSFileManager.defaultManager().createSymbolicLinkAtPath_withDestinationPath_error(t,e,n);if(null!==n.value())throw new Error(n.value())},e.exports.truncateSync=function(e,t){var n=NSFileHandle.fileHandleForUpdatingAtPath(sFilePath);n.truncateFileAtOffset(t||0),n.closeFile()},e.exports.unlinkSync=function(e){var t=MOPointer.alloc().init();NSFileManager.defaultManager().removeItemAtPath_error(e,t);if(null!==t.value())throw new Error(t.value())},e.exports.utimesSync=function(e,t,n){var r=MOPointer.alloc().init();NSFileManager.defaultManager().setAttributes_ofItemAtPath_error({NSFileModificationDate:t},e,r);if(null!==r.value())throw new Error(r.value())},e.exports.writeFileSync=function(e,t,n){var i=a(n,"utf8");r.from(t,"NSData"===i||"buffer"===i?void 0:i).toNSData().writeToFile_atomically(e,!0)}},"./node_modules/@skpm/timers/immediate.js":
/*!************************************************!*\
  !*** ./node_modules/@skpm/timers/immediate.js ***!
  \************************************************/
/*! no static exports found */function(e,t,n){var r=n(/*! ./timeout */"./node_modules/@skpm/timers/timeout.js");e.exports={setImmediate:function(e,t,n,i,o,a,c,s,l,u,f){return r.setTimeout(e,0,t,n,i,o,a,c,s,l,u,f)},clearImmediate:function(e){return r.clearTimeout(e)}}},"./node_modules/@skpm/timers/test-if-fiber.js":
/*!****************************************************!*\
  !*** ./node_modules/@skpm/timers/test-if-fiber.js ***!
  \****************************************************/
/*! no static exports found */function(e,t){e.exports=function(){return"undefined"!=typeof coscript&&coscript.createFiber}},"./node_modules/@skpm/timers/timeout.js":
/*!**********************************************!*\
  !*** ./node_modules/@skpm/timers/timeout.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,n){var r,i,o=[];if(n(/*! ./test-if-fiber */"./node_modules/@skpm/timers/test-if-fiber.js")()){o=[];r=function(e,t,n,r,i,a,c,s,l,u,f,d){var h=o.length;return o.push(coscript.scheduleWithInterval_jsFunction((t||0)/1e3,function(){e(n,r,i,a,c,s,l,u,f,d)})),h},i=function(e){var t=o[e];t&&(t.cancel(),o[e]=void 0)}}else r=function(e,t,n,r,a,c,s,l,u,f,d,h){coscript.shouldKeepAround=!0;var p=o.length;return o.push(!0),coscript.scheduleWithInterval_jsFunction((t||0)/1e3,function(){o[p]&&e(n,r,a,c,s,l,u,f,d,h),i(p),o.every(function(e){return!e})&&(coscript.shouldKeepAround=!1)}),p},i=function(e){o[e]=!1};e.exports={setTimeout:r,clearTimeout:i}},"./node_modules/cocoascript-class/lib/index.js":
/*!*****************************************************!*\
  !*** ./node_modules/cocoascript-class/lib/index.js ***!
  \*****************************************************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SuperCall=void 0,t.default=function(e){const t=e.superclass||NSObject,n=(e.className||e.classname||"ObjCClass")+NSUUID.UUID().UUIDString(),o=new Set(["className","classname","superclass"]);var a=MOClassDescription.allocateDescriptionForClassWithName_superclass_(n,t);const c=[];for(var s in e){const t=e[s];if("function"==typeof t&&"init"!==s){var l=NSSelectorFromString(s);a.addInstanceMethodWithSelector_function_(l,t)}else o.has(s)||(c.push(s),a.addInstanceVariableWithName_typeEncoding(s,"@"))}return a.addInstanceMethodWithSelector_function_(NSSelectorFromString("init"),function(){const t=i.call(this);return c.map(n=>{Object.defineProperty(t,n,{get:()=>(function(e,t){const n=MOPointer.new();return(0,r.object_getInstanceVariable)(e,t,n),n.value().retain().autorelease()})(t,n),set(e){(0,r.object_setInstanceVariable)(t,n,e)}}),t[n]=e[n]}),"function"==typeof e.init&&e.init.call(this),t}),a.registerClass()};var r=n(/*! ./runtime.js */"./node_modules/cocoascript-class/lib/runtime.js");t.SuperCall=r.SuperCall;const i=(0,r.SuperCall)(NSStringFromSelector("init"),[],{type:"@"})},"./node_modules/cocoascript-class/lib/runtime.js":
/*!*******************************************************!*\
  !*** ./node_modules/cocoascript-class/lib/runtime.js ***!
  \*******************************************************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SuperCall=function(e,t,n){const i=o("objc_msgSendSuper",[{type:"^"+r},{type:":"},...t],n);return function(...t){const n=function(e,t){return function e(t){if("object"!=typeof t||0==Object.keys(t).length)return t;const n=Object.keys(t)[0];const r=t[n];const i=MOStruct.structureWithName_memberNames_runtime(n,Object.keys(r),Mocha.sharedRuntime());Object.keys(r).map(t=>{i[t]=e(r[t])});return i}({objc_super:{receiver:e,super_class:t}})}(this,this.superclass()),r=MOPointer.alloc().initWithValue_(n);return i(r,e,...t)}},t.CFunc=o;const r='{objc_super="receiver"@"super_class"#}';function i(e,t){const n=NSMutableDictionary.dictionary();n.o=e,Object.keys(t).map(e=>n.setValue_forKeyPath(t[e],"o."+e))}function o(e,t,n){function r(e){if(!e)return null;const t=MOBridgeSupportArgument.alloc().init();return i(t,{type64:e.type}),t}const o=MOBridgeSupportFunction.alloc().init();return i(o,{name:e,arguments:t.map(r),returnValue:r(n)}),o}t.object_getInstanceVariable=o("object_getInstanceVariable",[{type:"@"},{type:"*"},{type:"^@"}],{type:"^{objc_ivar=}"}),t.object_setInstanceVariable=o("object_setInstanceVariable",[{type:"@"},{type:"*"},{type:"@"}],{type:"^{objc_ivar=}"});!function(e,t){const n=MOBridgeSupportController.sharedController().valueForKey("symbols");if(!n)throw Error("Something has changed within bridge support so we can't add our definitions");if(null!==n[e])return;const r=MOBridgeSupportStruct.alloc().init();i(r,{name:e,type:t.type}),n[e]=r}("objc_super",{type:r})},"./node_modules/promise-polyfill/lib/index.js":
/*!****************************************************!*\
  !*** ./node_modules/promise-polyfill/lib/index.js ***!
  \****************************************************/
/*! no static exports found */function(e,t,n){"use strict";(function(t,n){var r=t;function i(){}function o(e){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(e,this)}function a(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,o._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void s(t.promise,e)}c(t.promise,r)}else(1===e._state?c:s)(t.promise,e._value)})):e._deferreds.push(t)}function c(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void u(function(e,t){return function(){e.apply(t,arguments)}}(n,t),e)}e._state=1,e._value=t,l(e)}catch(t){s(e,t)}}function s(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function u(e,t){var n=!1;try{e(function(e){n||(n=!0,c(t,e))},function(e){n||(n=!0,s(t,e))})}catch(e){if(n)return;n=!0,s(t,e)}}o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var n=new this.constructor(i);return a(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,n)),n},o.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})},o.all=function(e){return new o(function(t,n){if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var i=r.length;function o(e,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,function(t){o(e,t)},n)}r[e]=a,0==--i&&t(r)}catch(e){n(e)}}for(var a=0;a<r.length;a++)o(a,r[a])})},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o(function(t){t(e)})},o.reject=function(e){return new o(function(t,n){n(e)})},o.race=function(e){return new o(function(t,n){for(var r=0,i=e.length;r<i;r++)e[r].then(t,n)})},o._immediateFn="function"==typeof n&&function(e){n(e)}||function(e){r(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},e.exports=o}).call(this,n(/*! ./node_modules/@skpm/timers/timeout.js */"./node_modules/@skpm/timers/timeout.js").setTimeout,n(/*! ./node_modules/@skpm/timers/immediate.js */"./node_modules/@skpm/timers/immediate.js").setImmediate)},"./node_modules/sketch-polyfill-fetch/lib/index.js":
/*!*********************************************************!*\
  !*** ./node_modules/sketch-polyfill-fetch/lib/index.js ***!
  \*********************************************************/
/*! no static exports found */function(e,t,n){(function(t){var r,i,o=n(/*! cocoascript-class */"./node_modules/cocoascript-class/lib/index.js").default;try{r=n(/*! buffer */"buffer").Buffer}catch(e){}e.exports=function(e,n){var a;n=n||{};try{a=coscript.createFiber()}catch(e){coscript.shouldKeepAround=!0}return new t(function(c,s){var l=NSURL.alloc().initWithString(e),u=NSMutableURLRequest.requestWithURL(l);if(u.setHTTPMethod(n.method||"GET"),Object.keys(n.headers||{}).forEach(function(e){u.setValue_forHTTPHeaderField(n.headers[e],e)}),n.body){var f;if("string"==typeof n.body)f=NSString.alloc().initWithString(n.body).dataUsingEncoding(NSUTF8StringEncoding);else if(r&&r.isBuffer(n.body))f=n.body.toNSData();else if(n.body.isKindOfClass&&1==n.body.isKindOfClass(NSData))f=n.body;else if(n.body._isFormData){var d=n.body._boundary;(f=n.body._data).appendData(NSString.alloc().initWithString("--"+d+"--\r\n").dataUsingEncoding(NSUTF8StringEncoding)),u.setValue_forHTTPHeaderField("multipart/form-data; boundary="+d,"Content-Type")}else f=NSJSONSerialization.dataWithJSONObject_options_error(n.body,NSJSONWritingPrettyPrinted,void 0),u.setValue_forHTTPHeaderField(""+f.length(),"Content-Length");u.setHTTPBody(f)}if(n.cache)switch(n.cache){case"reload":case"no-cache":case"no-store":u.setCachePolicy(1);case"force-cache":u.setCachePolicy(2);case"only-if-cached":u.setCachePolicy(3)}n.credentials||u.setHTTPShouldHandleCookies(!1),i||(i=o({classname:"FetchPolyfillDelegate",data:null,httpResponse:null,fiber:null,callbacks:null,"connectionDidFinishLoading:":function(e){this.callbacks.succeed(this.httpResponse,this.data),this.fiber?this.fiber.cleanup():coscript.shouldKeepAround=!1},"connection:didReceiveResponse:":function(e,t){this.httpResponse=t,this.data=NSMutableData.alloc().init()},"connection:didFailWithError:":function(e,t){this.callbacks.fail(t),this.fiber?this.fiber.cleanup():coscript.shouldKeepAround=!1},"connection:didReceiveData:":function(e,t){this.data.appendData(t)}}));var h=!1,p=i.new();p.callbacks=NSDictionary.dictionaryWithDictionary({succeed:function(e,n){h=!0,c(function e(n,i){for(var o,a=[],c=[],s={},l=0;l<n.allHeaderFields().allKeys().length;l++){var u=n.allHeaderFields().allKeys()[l].toLowerCase(),f=String(n.allHeaderFields()[u]);a.push(u),c.push([u,f]),o=s[u],s[u]=o?o+","+f:f}return{ok:1==(n.statusCode()/200|0),status:Number(n.statusCode()),statusText:NSHTTPURLResponse.localizedStringForStatusCode(n.statusCode()),useFinalURL:!0,url:String(n.URL().absoluteString()),clone:e.bind(this,n,i),text:function(){return new t(function(e,t){const n=NSString.alloc().initWithData_encoding(i,NSASCIIStringEncoding);n?e(n):t(new Error("Couldn't parse body"))})},json:function(){return new t(function(e,t){var n=NSString.alloc().initWithData_encoding(i,NSUTF8StringEncoding);n?e(JSON.parse(n)):t(new Error("Could not parse JSON because it is not valid UTF-8 data."))})},blob:function(){return t.resolve(i)},arrayBuffer:function(){return t.resolve(r.from(i))},headers:{keys:function(){return a},entries:function(){return c},get:function(e){return s[e.toLowerCase()]},has:function(e){return e.toLowerCase()in s}}}}(e,n))},fail:function(e){h=!0,s(e)}}),p.fiber=a;var m=NSURLConnection.alloc().initWithRequest_delegate(u,p);a&&a.onCleanup(function(){h||m.cancel()})})}}).call(this,n(/*! ./node_modules/promise-polyfill/lib/index.js */"./node_modules/promise-polyfill/lib/index.js"))},"./src/DataProvider.js":
/*!*****************************!*\
  !*** ./src/DataProvider.js ***!
  \*****************************/
/*! exports provided: onStartup, onShutdown, onSupplyRandomPhoto, onSearchPhoto, default */function(e,t,n){"use strict";n.r(t),function(e,r){n.d(t,"onStartup",function(){return m}),n.d(t,"onShutdown",function(){return S}),n.d(t,"onSupplyRandomPhoto",function(){return y}),n.d(t,"onSearchPhoto",function(){return v}),n.d(t,"default",function(){return _});var i=n(/*! os */"os"),o=n(/*! path */"path"),a=n(/*! util */"util"),c=n(/*! @skpm/fs */"./node_modules/@skpm/fs/index.js"),s=n(/*! sketch */"sketch"),l=n(/*! ./unsplash */"./src/unsplash.js").getImagesURLsForItems,u=s.DataSupplier,f=s.UI,d=s.Settings,h="unsplash.photo.id",p=o.join(i.tmpdir(),"com.sketchapp.unsplash-plugin");function m(){u.registerDataSupplier("public.image","Random Photo","SupplyRandomPhoto"),u.registerDataSupplier("public.image","Search Photo…","SearchPhoto")}function S(){u.deregisterDataSuppliers();try{c.existsSync(p)&&c.rmdirSync(p)}catch(e){console.error(e)}}function y(e){N(e)}function b(e){return"id:"===e.substr(0,3)||-1!==e.indexOf("unsplash.com/photos/")}function g(e){if("id:"===e.substr(0,3))return e.substr(3);var t=e.substr(e.indexOf("unsplash.com/photos/")+20),n=t.search(/[^a-z0-9_-]/i);return-1!==n?t.substr(0,n):t}function v(e){var t=s.getSelectedDocument().selectedLayers.layers,n=t.map(function(e){return d.layerSettingForKey(e,"unsplash.search.term")}).find(function(e){return void 0!==e})||"People";if(s.version.sketch<53){var r=f.getStringFromUser("Search Unsplash for…",n).trim();"null"!==r&&(t.forEach(function(e){d.setLayerSettingForKey(e,"unsplash.search.term",r)}),b(r)?N(e,null,g(r)):N(e,r.replace(/\s+/g,"-").toLowerCase()))}else f.getInputFromUser("Search Unsplash for…",{initialValue:n},function(n,r){n||"null"!==(r=r.trim())&&(t.forEach(function(e){d.setLayerSettingForKey(e,"unsplash.search.term",r)}),b(r)?N(e,null,g(r)):N(e,r.replace(/\s+/g,"-").toLowerCase()))})}function _(){var e=s.getSelectedDocument(),t=e?e.selectedLayers:[];t.length>0?t.forEach(function(e){var t=d.layerSettingForKey(e,h)||"SymbolInstance"===e.type&&e.overrides.map(function(e){return d.layerSettingForKey(e,h)}).find(function(e){return!!e});t?NSWorkspace.sharedWorkspace().openURL(NSURL.URLWithString("https://unsplash.com/photos/".concat(t))):f.message("To get a random photo, click Data › Unsplash › Random Photo in the toolbar, or right click the layer › Data Feeds › Unsplash › Random Photo")}):f.message("Please select at least one layer")}function N(t,n,i){var o=t.data.key,c=a.toArray(t.data.items).map(s.fromNative);f.message("🕑 Downloading…"),l(c,{searchTerm:n,photoId:i}).then(function(n){return e.all(n.map(function(e){var n=e.data,i=e.item,a=e.index,c=e.frame,s=e.error;s?(f.message(s),console.error(s)):function(e,n,i,o,a){(function(e,n){return r("".concat(e,"&fit=min&w=").concat(4*n.width,"&h=").concat(4*n.height)).then(function(e){return e.blob()}).then(F).catch(function(e){return console.error(e),t.plugin.urlForResourceNamed("placeholder.png").path()})})(e.urls.full,a).then(function(t){t&&(u.supplyDataAtIndex(n,t,i),"DataOverride"!==o.type&&d.setLayerSettingForKey(o,h,e.id),f.message("📷 by "+e.user.name+" on Unsplash"))})}(n,o,a,i,c)}))}).catch(function(e){f.message(e),console.error(e)})}function F(e){var t=NSProcessInfo.processInfo().globallyUniqueString(),n=o.join(p,"".concat(t,".jpg"));try{c.mkdirSync(p)}catch(e){}try{return c.writeFileSync(n,e,"NSData"),n}catch(e){return void console.error(e)}}}.call(this,n(/*! ./node_modules/promise-polyfill/lib/index.js */"./node_modules/promise-polyfill/lib/index.js"),n(/*! ./node_modules/sketch-polyfill-fetch/lib/index.js */"./node_modules/sketch-polyfill-fetch/lib/index.js"))},"./src/unsplash.js":
/*!*************************!*\
  !*** ./src/unsplash.js ***!
  \*************************/
/*! exports provided: getImagesURLsForItems */function(e,t,n){"use strict";n.r(t),function(e,r){function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"getImagesURLsForItems",function(){return f});var o=n(/*! sketch */"sketch"),a=n(/*! util */"util").toArray,c="bfd993ac8c14516588069b3fc664b216d0e20fb9b9fa35aa06fcc3ba6e0bc703",s="https://api.unsplash.com",l={headers:{"app-pragma":"no-cache"}};function u(e){return e.reduce(function(e,t){return e.concat(t)},[])}function f(t,n){var f=n.searchTerm,d=n.photoId,h=t.reduce(function(e,t,n){var r;if(t.type||(t=o.Shape.fromNative(t.sketchObject)),"DataOverride"===t.type){var i=t.override.getFrame&&t.override.getFrame();if(i)r={frame:i};else{var c=a(t.symbolInstance.sketchObject.overrideContainer().flattenedChildren()).find(function(e){return e.availableOverride()==t.override.sketchObject});if(c){var s=c.pathInInstance(),l=CGPathGetBoundingBox(s);r={frame:{width:Number(l.size.width),height:Number(l.size.height)}}}else r=t.symbolInstance}}else r=t;return r.frame.width>r.frame.height?e.landscape.push({item:t,index:n,frame:r.frame}):r.frame.width<r.frame.height?e.portrait.push({item:t,index:n,frame:r.frame}):r.frame.width===r.frame.height&&e.squarish.push({item:t,index:n,frame:r.frame}),e},{landscape:[],portrait:[],squarish:[]}),p=d?"/photos/".concat(d):"/photos/random",m=s+p+"?client_id="+c;return d||f&&(m+="&query="+f),e.all(Object.keys(h).map(function(t){var n=h[t];if(!n||!n.length)return e.resolve([]);var o=Math.ceil(n.length/30);return e.all(Array(o).fill().map(function(a,c){var s=c===o-1?n.length%30:30;return r("".concat(m,"&count=").concat(s,"&orientation=").concat(t),l).then(function(e){return e.json()}).then(function(t){return t.errors?e.reject(t.errors[0]):t.map(function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){i(e,t,n[t])})}return e}({data:e},n[30*c+t])})}).catch(function(e){return[{error:e}]})})).then(u)})).then(u)}}.call(this,n(/*! ./node_modules/promise-polyfill/lib/index.js */"./node_modules/promise-polyfill/lib/index.js"),n(/*! ./node_modules/sketch-polyfill-fetch/lib/index.js */"./node_modules/sketch-polyfill-fetch/lib/index.js"))},buffer:
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/*! no static exports found */function(e,t){e.exports=require("buffer")},os:
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/*! no static exports found */function(e,t){e.exports=require("os")},path:
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/*! no static exports found */function(e,t){e.exports=require("path")},sketch:
/*!*************************!*\
  !*** external "sketch" ***!
  \*************************/
/*! no static exports found */function(e,t){e.exports=require("sketch")},util:
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/*! no static exports found */function(e,t){e.exports=require("util")}});"default"===e&&"function"==typeof n?n(t):n[e](t)}that["[object Object]"]=__skpm_run.bind(this,"[object Object]"),that.onRun=__skpm_run.bind(this,"default"),that.onStartup=__skpm_run.bind(this,"onStartup"),that.onShutdown=__skpm_run.bind(this,"onShutdown"),that.onSupplyRandomPhoto=__skpm_run.bind(this,"onSupplyRandomPhoto"),that.onSearchPhoto=__skpm_run.bind(this,"onSearchPhoto");